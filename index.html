<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Dark Creed Alliance</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- Skeleton Loading Templates -->
    <div id="skeletonContainer" class="skeleton-container">
      <div class="container">
        <!-- Timeline Skeleton -->
        <div class="timeline">
          <h2>Alliance Timeline (Server Time UTC-2)</h2>
          <div class="skeleton-timeline">
            <div class="skeleton skeleton-timeline-header"></div>
            <div class="skeleton-timeline-row">
              <div class="skeleton skeleton-timeline-day"></div>
              <div class="skeleton-timeline-slots">
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
              </div>
            </div>
            <div class="skeleton-timeline-row">
              <div class="skeleton skeleton-timeline-day"></div>
              <div class="skeleton-timeline-slots">
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
              </div>
            </div>
            <div class="skeleton-timeline-row">
              <div class="skeleton skeleton-timeline-day"></div>
              <div class="skeleton-timeline-slots">
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
                <div class="skeleton skeleton-timeline-slot"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Members Skeleton -->
        <div style="margin: 40px 0 20px">
          <h2 style="color: #4a9eff; text-align: center; margin-bottom: 20px">
            Alliance Members
          </h2>
          <div class="members-grid">
            <div class="skeleton-member-card">
              <div class="skeleton skeleton-title"></div>
              <div class="skeleton skeleton-stats"></div>
              <div class="skeleton skeleton-timezone"></div>
              <div class="skeleton-availability">
                <div class="skeleton skeleton-availability-day"></div>
                <div class="skeleton skeleton-availability-day"></div>
                <div class="skeleton skeleton-availability-day"></div>
              </div>
            </div>
            <div class="skeleton-member-card">
              <div class="skeleton skeleton-title"></div>
              <div class="skeleton skeleton-stats"></div>
              <div class="skeleton skeleton-timezone"></div>
              <div class="skeleton-availability">
                <div class="skeleton skeleton-availability-day"></div>
                <div class="skeleton skeleton-availability-day"></div>
              </div>
            </div>
            <div class="skeleton-member-card">
              <div class="skeleton skeleton-title"></div>
              <div class="skeleton skeleton-stats"></div>
              <div class="skeleton skeleton-timezone"></div>
              <div class="skeleton-availability">
                <div class="skeleton skeleton-availability-day"></div>
                <div class="skeleton skeleton-availability-day"></div>
                <div class="skeleton skeleton-availability-day"></div>
                <div class="skeleton skeleton-availability-day"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Mobile Settings Button -->
    <button
      class="mobile-settings-btn"
      onclick="toggleMobileSettings()"
      id="mobileSettingsBtn"
    >
      ‚öôÔ∏è
    </button>

    <!-- Mobile Settings Panel -->
    <div class="mobile-settings-panel" id="mobileSettingsPanel">
      <div class="mobile-settings-content">
        <div class="mobile-language-section">
          <h4 data-translate="language">Language</h4>
          <div class="mobile-language-options">
            <div class="mobile-language-option" onclick="changeLanguage('en')">
              <span class="flag">&#127482;&#127480;</span>
              <span class="lang-name">English</span>
            </div>
            <div class="mobile-language-option" onclick="changeLanguage('pt')">
              <span class="flag">&#127463;&#127479;</span>
              <span class="lang-name">Portugu√™s</span>
            </div>
            <div class="mobile-language-option" onclick="changeLanguage('fr')">
              <span class="flag">&#127467;&#127479;</span>
              <span class="lang-name">Fran√ßais</span>
            </div>
            <div class="mobile-language-option" onclick="changeLanguage('es')">
              <span class="flag">&#127466;&#127480;</span>
              <span class="lang-name">Espa√±ol</span>
            </div>
            <div class="mobile-language-option" onclick="changeLanguage('it')">
              <span class="flag">&#127470;&#127481;</span>
              <span class="lang-name">Italiano</span>
            </div>
          </div>
        </div>
        <div class="mobile-logout-section">
          <button
            class="btn btn-danger mobile-logout-btn"
            onclick="logout()"
            data-translate="logout"
          >
            Logout
          </button>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="header-content">
        <div class="header-main">
          <h1>The Dark Creed</h1>
          <p class="subtitle" data-translate="subtitle">
            Unite. Strategize. Dominate.
          </p>
        </div>
        <div class="language-selector">
          <button class="language-btn" id="languageBtn">
            <span id="currentFlag">&#127482;&#127480;</span>
            <span class="language-arrow">‚ñº</span>
          </button>
          <div class="language-menu" id="languageMenu">
            <div class="language-option" data-lang="en">
              <span class="flag">&#127482;&#127480;</span>
              <span class="lang-name">English</span>
            </div>
            <div class="language-option" data-lang="pt">
              <span class="flag">&#127463;&#127479;</span>
              <span class="lang-name">Portugu√™s</span>
            </div>
            <div class="language-option" data-lang="fr">
              <span class="flag">&#127467;&#127479;</span>
              <span class="lang-name">Fran√ßais</span>
            </div>
            <div class="language-option" data-lang="es">
              <span class="flag">&#127466;&#127480;</span>
              <span class="lang-name">Espa√±ol</span>
            </div>
            <div class="language-option" data-lang="it">
              <span class="flag">&#127470;&#127481;</span>
              <span class="lang-name">Italiano</span>
            </div>
          </div>
        </div>
        <button
          class="btn btn-danger"
          onclick="logout()"
          id="logoutBtn"
          style="display: none"
          data-translate="logout"
        >
          Logout
        </button>
      </div>

      <!-- Tab Navigation -->
      <div class="tab-navigation">
        <div class="tab-container">
          <button class="tab-btn active" data-tab="submit-info" onclick="switchTab('submit-info')">
            <span class="tab-icon">üìù</span>
            <span class="tab-text" data-translate="submitInfoTab">Submit Info</span>
          </button>
          <button class="tab-btn" data-tab="registration-form" onclick="switchTab('registration-form')">
            <span class="tab-icon">üìã</span>
            <span class="tab-text" data-translate="registrationFormTab">Registration Form</span>
          </button>
          <button class="tab-btn" data-tab="view-alliance" onclick="switchTab('view-alliance')">
            <span class="tab-icon">üë•</span>
            <span class="tab-text" data-translate="viewAllianceTab">View Alliance</span>
          </button>
        </div>
      </div>

      <!-- Timezone Confirmation Modal -->
      <div id="timezoneModal" class="modal-overlay">
        <div class="modal-content">
          <h3 data-translate="timezoneTitle">üåç Confirm Your Timezone</h3>
          <p data-translate="timezoneDescription">
            We've detected your timezone automatically. Please confirm it's
            correct before proceeding:
          </p>

          <div class="timezone-info">
            <h4 data-translate="detectedInfo">üìç Detected Information</h4>
            <div class="timezone-comparison">
              <div class="timezone-item">
                <h5 data-translate="yourLocalTime">Your Local Time</h5>
                <div class="time" id="userLocalTime">--:--</div>
                <div class="zone" id="userTimezone">Loading...</div>
              </div>
              <div class="timezone-item">
                <h5 data-translate="serverTime">Server Time</h5>
                <div class="time" id="serverTime">--:--</div>
                <div class="zone">UTC-2</div>
              </div>
            </div>

            <div class="time-relationship">
              <div class="relationship-text" id="timeRelationship">
                Calculating...
              </div>
            </div>
          </div>

          <p style="margin-bottom: 25px">
            <strong>Important:</strong>
            <span data-translate="timezoneImportant"
              >Your time slot selections will be converted to server time
              (UTC-2) for coordination.</span
            >
          </p>

          <div class="modal-buttons">
            <button
              class="btn btn-success"
              onclick="confirmTimezone()"
              data-translate="confirmContinue"
            >
              ‚úÖ Confirm & Continue
            </button>
            <button
              class="btn"
              onclick="changeTimezone()"
              data-translate="changeTimezone"
            >
              üîÑ Change Timezone
            </button>
          </div>
        </div>
      </div>

      <!-- Custom Dialog Modal -->
      <div id="customModal" class="modal-overlay">
        <div class="modal-content">
          <h3 id="customModalTitle"></h3>
          <p id="customModalMessage"></p>
          <div id="customModalInput" style="display: none; margin: 20px 0;">
            <input type="text" id="customModalInputField" style="width: 100%; padding: 12px; background: rgba(10, 10, 10, 0.8); border: 1px solid rgba(74, 158, 255, 0.3); color: #e0e0e0; border-radius: 10px; font-size: 16px; transition: all 0.3s ease;">
          </div>
          <div class="modal-buttons" id="customModalButtons">
            <!-- Buttons will be dynamically added here -->
          </div>
        </div>
      </div>

      <!-- Submit Info Tab Content -->
      <div id="submit-info-tab" class="tab-content active">
        <div id="authSection" class="auth-section">
          <h2 data-translate="authRequired">Authentication Required</h2>
          <p style="margin-bottom: 15px">
            <span id="authStatus" data-translate="notAuthenticated"
              >Not authenticated</span
            >
          </p>
          <div id="authControls">
            <input
              type="password"
              id="githubToken"
              data-translate-placeholder="githubTokenPlaceholder"
              placeholder="GitHub Token (required for all members)"
            />
            <button
              class="btn"
              onclick="authenticate()"
              data-translate="authenticate"
            >
              Authenticate
            </button>
            <p style="color: #888; font-size: 14px; margin-top: 10px">
              <strong
                ><span data-translate="authDescription"
                  >All members must authenticate before submitting
                  information.</span
                ></strong
              ><br />
              <span data-translate="contactR4R5"
                >Contact your alliance R4/R5 for the GitHub token.</span
              >
            </p>
          </div>
        </div>

        <div class="member-form">
        <h2 data-translate="submitInfo">Submit Your Information</h2>

        <!-- Update Instructions -->
        <div
          style="
            background: #1a1a2e;
            border: 1px solid #4a9eff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
          "
        >
          <h4
            style="color: #4a9eff; margin: 0 0 10px 0"
            data-translate="howUpdatesWork"
          >
            üí° How Updates Work
          </h4>
          <div style="color: #ccc; font-size: 14px; line-height: 1.5">
            <p style="margin: 0 0 8px 0">
              <strong>Quick Update:</strong>
              <span data-translate="quickUpdate"
                >Enter your username + new car power and/or tower level ‚Üí your
                time slots stay the same</span
              >
            </p>
            <p style="margin: 0 0 8px 0">
              <strong>Full Update:</strong>
              <span data-translate="fullUpdate"
                >Enter your username + select new time slots ‚Üí update everything
                (car power/tower optional)</span
              >
            </p>
            <p
              style="margin: 0; color: #888; font-size: 13px"
              data-translate="newMembersNote"
            >
              New members must fill all fields including time slots
            </p>
          </div>
        </div>

        <!-- Timezone Status Display -->
        <div id="timezoneStatus" class="timezone-status" style="display: none">
          <h4 data-translate="timezoneConfirmed">‚úÖ Timezone Confirmed</h4>
          <p id="confirmedTimezoneText">--</p>
          <button
            class="change-btn"
            onclick="changeTimezone()"
            data-translate="changeTimezone"
          >
            Change Timezone
          </button>
        </div>

        <!-- Timezone Locked Message -->
        <div
          id="timezoneLocked"
          class="timezone-locked-message"
          style="display: block"
        >
          <h3 data-translate="timezoneSetupRequired">
            üîí Timezone Setup Required
          </h3>
          <p data-translate="confirmTimezoneFirst">
            Please confirm your timezone first to enable time slot selection.
          </p>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label data-translate="inGameUsername">In-Game Username</label>
            <input
              type="text"
              id="username"
              data-translate-placeholder="usernamePlaceholder"
              placeholder="Your username"
            />
          </div>
          <div class="form-group">
            <label data-translate="mainCarPower">Main Car Power</label>
            <input
              type="number"
              id="carPower"
              data-translate-placeholder="carPowerPlaceholder"
              placeholder="e.g., 150000"
            />
          </div>
          <div class="form-group">
            <label data-translate="towerLevel">Tower Level</label>
            <input
              type="number"
              id="towerLevel"
              min="1"
              max="33"
              data-translate-placeholder="towerLevelPlaceholder"
              placeholder="1-33"
            />
          </div>
          <div
            class="form-group"
            id="manualTimezoneGroup"
            style="display: none"
          >
            <label>Timezone</label>
            <select id="timezone"></select>
            <small
              id="serverTimeInfo"
              style="color: #888; display: block; margin-top: 5px"
            ></small>
          </div>
        </div>
        <h3 style="margin: 20px 0 10px" data-translate="availableTimeSlots">
          Available Time Slots
        </h3>
        <p
          style="color: #888; margin-bottom: 15px; font-size: 14px"
          data-translate="timeSlotDescription"
        >
          Select when you're usually available (2-hour blocks in your local
          time)
        </p>
        <div id="timeSlotHeaders"></div>
        <div id="timeSlotInputs"></div>
        <button
          class="btn btn-success"
          onclick="submitMemberInfo()"
          id="submitBtn"
          data-translate="submitInformation"
        >
          Submit Information
        </button>
        </div>
      </div>

      <!-- Registration Form Tab Content -->
      <div id="registration-form-tab" class="tab-content">
        <div class="member-form">
          <h2 data-translate="registrationForm">Registration Form</h2>
          <div style="
            background: #1a1a2e;
            border: 1px solid #4a9eff;
            border-radius: 8px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
          ">
            <h3 style="color: #4a9eff; margin-bottom: 15px;">üìã Coming Soon</h3>
            <p style="color: #ccc; margin-bottom: 0;">
              This registration form will be implemented soon. Stay tuned for updates!
            </p>
          </div>
        </div>
      </div>

      <!-- View Alliance Tab Content -->
      <div id="view-alliance-tab" class="tab-content">
        <div class="timeline">
          <h2 data-translate="allianceTimeline">
            Alliance Timeline (Server Time UTC-2)
          </h2>
          <div id="timelineView"></div>
        </div>

        <div style="margin: 40px 0 20px">
          <div class="members-header">
            <h2
              id="allianceMembersTitle"
              style="color: #4a9eff; text-align: center; margin-bottom: 20px"
            >
              Alliance Members
            </h2>
            <div class="member-search-container">
              <input
                type="text"
                id="memberSearchInput"
                class="member-search-input"
                placeholder="Search members..."
                oninput="filterMembers()"
              />
              <div class="search-icon">üîç</div>
            </div>
          </div>
          <div class="members-grid" id="membersGrid"></div>
        </div>
      </div>
    </div>

    <script src="translations.js"></script>
    <script src="script.js"></script>
  </body>
</html>
